---
title: "【Next.js 15】 [CVE-2025-66478] React Server Components の重大な脆弱性と対応ガイド"
emoji: "🚨
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["nextjs15","rsc","cve"]
published: false
---


## はじめに

2025年12月、Next.js 公式ブログにおいて React Server Components (RSC) に関連する重大な脆弱性 `CVE-2025-66478` が告知されました。
本件は、上流である React の脆弱性 `CVE-2025-55182` に起因するもので、Next.js 15 および 16 を含む広範なバージョンに影響が生じます。

CVSS スコアは **10.0** と評価されており、Remote Code Execution（遠隔コード実行）に至る可能性があるため、該当バージョンを利用している場合は直ちに対応が必要です。
本記事では、脆弱性の技術的背景を整理しつつ、開発者が取るべき実務的なアップデート手順と事後対応についてまとめます。

## 対象者

* React 19 系および Next.js 15 / 16 を利用している開発者
* Server Components の内部動作やセキュリティ背景に関心がある方
* プロジェクトで迅速かつ安全なアップデートを行う必要がある技術者

## 結論

* **影響範囲**: Next.js 15 系および 16 系の全バージョン
* **リスク**: RSC の評価過程における外部データ混入により、サーバー上で意図しないコードが実行される恐れがある (CVSS 10.0)
* **対応**: パッチ済みバージョンへの更新で完全に解消される

:::message alert
**シークレット情報のローテーションについて**
公式ブログでは、**2025年12月5日 午前6時（日本時間）** 時点で未修正のまま公開状態にあったアプリケーションについて、念のため **シークレット情報（APIキー、DBパスワード等）をローテーションすること** が強く推奨されています。
:::

**公式情報**

* [Next.js Blog - CVE-2025-66478](https://nextjs.org/blog/CVE-2025-66478)

## 脆弱性の技術的背景

今回の脆弱性は、RSC がサーバー側でコンポーネントを解決し、その結果を「Flight Protocol」としてクライアントにストリーム返却する仕組みの根幹に関わります。

### 問題の本質：評価過程への外部データ混入

本来、RSC のデータフローと評価タイミングは厳密に管理される前提で設計されています。しかし、今回のケースでは **クライアントから送信される RSC リクエストの一部が、意図しない形でサーバー側の評価対象として処理されてしまう** 欠陥が見つかりました。

これにより、攻撃者が細工した入力を行うことで、サーバー内部の関数呼び出しや特定の処理を誘発できる（Remote Code Execution）可能性があります。
これは学術的なセキュリティ研究においても「信頼できない入力のデシリアライズ」や「評価系へのデータ混入」として危険性が指摘されているパターンであり、システム深部での制御を奪われるリスクがあります。

## 修正済みバージョン

以下のパッチ済みバージョン、またはそれ以降に更新することで脆弱性は無効化されます。

* **15.0.5**
* **15.1.9**
* **15.2.6**
* **15.3.6**
* **15.4.8**
* **15.5.7**
* **16.0.7**

## 実務での対応手順

具体的なアップデートおよび確認手順は以下の通りです。

### Step 1: パッチ版への更新

`next`, `react`, `react-dom` を最新のパッチバージョンへ更新します。

```bash
$ pnpm add next@latest react@latest react-dom@latest

```

バージョンを厳密に固定する必要がある場合は、以下のように記述してください（例）。

```bash
$ pnpm add next@15.5.7 react@19.2.1 react-dom@19.2.1

```

### Step 2: ビルドとデプロイ

更新後、ビルドとデプロイを実施して本番環境へ反映させます。

```bash
$ pnpm build
$ git commit -am "chore: security update RSC CVE-2025-66478"
$ git push

```

Vercel 等のホスティングサービスを利用している場合、Push 後に自動デプロイが行われることを確認してください。

### Step 3: ログの確認と事後対応

本脆弱性は、直接的にデータを抜き出す形式（SQLインジェクション等）とは異なりますが、RSC 経路を悪用して内部挙動を操作された可能性があります。
念のため、以下の観点でログを確認することを推奨します。

* 不審な RSC リクエスト（異常なパラメータやペイロード）
* API キーや内部リソースに対する想定外のアクセス
* サーバーログにおける不明なエラーや警告

また、前述の通り、未修正期間中に公開されていた場合は **シークレットのローテーション** を検討してください。

## おわりに

今回の脆弱性は CVSS 10.0 という高い深刻度でしたが、パッチ提供あったことで、適切な運用フローさえあれば即時対応できる問題でもありました。

私自身、RSC のようなブラックボックス化しやすい基盤技術に対して、安全性への意識が希薄になっていたことに気付かされました。「フレームワーク側が守ってくれる」という前提に立ちつつも、その裏側でどのようなデータ評価が行われているのかを理解しておくことは、エンジニアとしての責務であると再認識する機会となりました。本記事が、皆様の安全なサービス運用の助けになれば幸いです。
