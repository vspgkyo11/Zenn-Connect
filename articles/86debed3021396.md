---
title: "ã€GASã€‘Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ã€Œäºˆå®šã€ã‚’æ¤œç´¢ãƒ»å¤‰æ›´ãƒ»ç§»å‹•ã—ã¦è‡ªå‹•æ•´ç†ã™ã‚‹æ–¹æ³•"
emoji: "ğŸ“…"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["GAS"]
published: true
---

## ã¯ã˜ã‚ã«

Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã€äºˆå®šã®æ•´ç†ã‚„åå‰ã®çµ±ä¸€ã‚’ã—ãŸããªã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ
ã—ã‹ã—ã€æ‰‹å‹•ã§ç·¨é›†ã™ã‚‹ã®ã¯ã¨ã¦ã‚‚å¤§å¤‰ã§ã™ã€‚

ãã“ã§ã€Google Apps Scriptï¼ˆGASï¼‰ã‚’æ´»ç”¨ã—ã¦ã€ç‰¹å®šã®äºˆå®šã‚’æ¤œç´¢ãƒ»å¤‰æ›´ãƒ»ç§»å‹•ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã€Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æ•´ç†ã‚’è‡ªå‹•åŒ–ã—ã¾ã—ãŸã€‚æœ¬è¨˜äº‹ã§ã¯ã€GASã‚’ä½¿ã£ã¦ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®äºˆå®šã‚’åŠ¹ç‡çš„ã«ç®¡ç†ã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚

## æœ¬è¨˜äº‹ã®å¯¾è±¡è€…

æœ¬è¨˜äº‹ã¯ã€ä»¥ä¸‹ã®å‡¦ç†ã‚’è¡Œã„ãŸã„æ–¹å‘ã‘ã§ã™ã€‚

- **ç‰¹å®šã®æ¡ä»¶ã«åˆã†äºˆå®šã‚’æ¤œç´¢ã—ãŸã„**ï¼ˆä¾‹ï¼š[XX] ã‹ã‚‰å§‹ã¾ã‚‹äºˆå®šï¼‰
- **äºˆå®šã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å¤‰æ›´ã—ãŸã„**ï¼ˆä¾‹ï¼š[XX] â†’ [YY]ï¼‰
- **äºˆå®šã‚’ç‰¹å®šã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¸ç§»å‹•ã—ãŸã„** ï¼ˆä¾‹ï¼š[äºˆå®š] â†’ [ã‚µãƒ–ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼]ï¼‰
- **ç‰¹å®šã®æœŸé–“ã®äºˆå®šã‚’å¤‰æ›´ã—ãŸã„** ï¼ˆä¾‹ï¼šéå»xxãƒ¶æœˆï½æœªæ¥xxãƒ¶æœˆï¼‰

---

## GASã§ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®äºˆå®šã‚’å–å¾—ã™ã‚‹æ–¹æ³•

ã¾ãšã¯ã€Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®äºˆå®šã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã§ã™ã€‚

### **ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ä¸€è¦§ã‚’å–å¾—**

```javascript
var calendars = CalendarApp.getAllCalendars(); // ã™ã¹ã¦ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’å–å¾—
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç´ã¥ã„ãŸã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã§ãã¾ã™ã€‚

### **éå»xxãƒ¶æœˆï½æœªæ¥xxãƒ¶æœˆã®äºˆå®šã‚’å–å¾—**

GASã§äºˆå®šã‚’å–å¾—ã™ã‚‹éš›ã€é€šå¸¸ã¯æœªæ¥ã®äºˆå®šã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ãŒã€éå»ã®äºˆå®šã‚‚æ¤œç´¢ã™ã‚‹ã“ã¨ã§ã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ã‚ˆã‚ŠæŸ”è»Ÿã«æ•´ç†ã§ãã¾ã™ã€‚

```javascript
var today = new Date();
var startDate = new Date(today.getFullYear(), today.getMonth() - 2, today.getDate()); // éå»2ãƒ¶æœˆå‰
var endDate = new Date(today.getFullYear(), today.getMonth() + 1, today.getDate()); // æœªæ¥1ãƒ¶æœˆå¾Œ
```

ã“ã® `startDate` ã¨ `endDate` ã‚’ `getEvents(startDate, endDate)` ã«æ¸¡ã›ã°ã€
éå»xxãƒ¶æœˆã‹ã‚‰æœªæ¥xxãƒ¶æœˆã®ç¯„å›²ã®äºˆå®šã‚’å–å¾—ã§ãã¾ã™ã€‚

---

## äºˆå®šã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ­£è¦è¡¨ç¾ã§æ¤œç´¢ï¼†å¤‰æ›´

GASã§ã¯ `match()` ã‚’ä½¿ã£ã¦ã€ç‰¹å®šã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆã†äºˆå®šã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ¤œç´¢ã§ãã¾ã™ã€‚

### **[XX] â†’ [YY] ã«å¤‰æ›´ã™ã‚‹å ´åˆ**

```javascript
if (title.match(/^\s*\[XX\]\s*/)) {
  var newTitle = title.replace(/^\s*\[XX\]\s*/, "[YY] ");
}
```

#### **ãƒã‚¤ãƒ³ãƒˆ**
- `^\s*\[XX\]\s*` â†’ ã‚¿ã‚¤ãƒˆãƒ«ã®å…ˆé ­ãŒ [XX] ã®äºˆå®šã‚’æ¤œç´¢
- `replace(/^\s*\[XX\]\s*/, "[YY] ")` â†’ [XX] ã‚’ [YY] ã«ç½®æ›

:::message
**[Tips]æ­£è¦è¡¨ç¾ã®åŸºæœ¬**
æ­£è¦è¡¨ç¾ã¯ã€ç‰¹å®šã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ä¸€è‡´ã™ã‚‹æ–‡å­—åˆ—ã‚’æ¤œç´¢ãƒ»ç½®æ›ã™ã‚‹ãŸã‚ã«ç‰¹æ®Šãªè¨˜å·ã‚’ç”¨ã„ã¦æ–‡å­—åˆ—ã§è¡¨ã™æ–¹æ³•ã§ã™ã€‚GASã§ã¯ã€match() ã‚„ replace() ã‚’ä½¿ã£ã¦ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®äºˆå®šã‚¿ã‚¤ãƒˆãƒ«ã‚’æŸ”è»Ÿã«æ“ä½œã§ãã¾ã™ã€‚

- `^` â†’ æ–‡å­—åˆ—ã®å…ˆé ­ ã«ä¸€è‡´
- `\s*` â†’ 0å€‹ä»¥ä¸Šã®ç©ºç™½ï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã‚„ã‚¿ãƒ–ï¼‰ ã«ä¸€è‡´
- `\[ \]` â†’ è§’æ‹¬å¼§ [] ã‚’ãã®ã¾ã¾ãƒãƒƒãƒ ã•ã›ã‚‹ãŸã‚ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼ˆ`\`ï¼‰ãŒå¿…è¦
:::

---

## äºˆå®šã‚’åˆ¥ã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¸ç§»å‹•ã™ã‚‹

GASã§ã¯ `createEvent()` ã‚’ä½¿ã„ã€æ–°ã—ã„ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«äºˆå®šã‚’ã‚³ãƒ”ãƒ¼ã§ãã¾ã™ã€‚

### **ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’æ¤œç´¢ & äºˆå®šã‚’ç§»å‹•ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**

```javascript
function updateAndMoveEventsToSports() {
  var calendars = CalendarApp.getAllCalendars();
  var targetCalendarName = "ã‚µãƒ–ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼"; // "ã‚µãƒ–ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼"ã‚’å¯¾è±¡ã¨ã™ã‚‹
  var today = new Date();
  var startDate = new Date(today.getFullYear(), today.getMonth() - 2, today.getDate());
  var endDate = new Date(today.getFullYear(), today.getMonth() + 1, today.getDate());
  var targetCalendar = calendars.find(calendar => calendar.getName() === targetCalendarName);
  if (!targetCalendar) {
    console.log("ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼[" + targetCalendarName + "]ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚");
    return;
  }
  var count = 0;
  calendars.forEach(function(calendar) {
    if (calendar.getName() === targetCalendarName) return;
    var events = calendar.getEvents(startDate, endDate);
    events.forEach(function(event) {
      var title = event.getTitle();
      if (title.match(/^\s*\[XX\]\s*/)) {
        var newTitle = title.replace(/^\s*\[XX\]\s*/, "[YY] ");
        targetCalendar.createEvent(newTitle, event.getStartTime(), event.getEndTime(), {
          location: event.getLocation(),
          description: event.getDescription()
        });
        event.deleteEvent();
        console.log("ç§»å‹•: " + calendar.getName() + " â†’ " + targetCalendarName + " | " + title + " â†’ " + newTitle);
        count++;
      }
    });
  });
  console.log("ç§»å‹•ãƒ»å¤‰æ›´ã—ãŸäºˆå®šã®åˆè¨ˆ: " + count);
}
```

---

## ãŠã‚ã‚Šã«

GASã‚’æ´»ç”¨ã™ã‚Œã°ã€Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æ•´ç†ãŒåœ§å€’çš„ã«æ¥½ã«ãªã‚Šã¾ã™ã€‚

ã€Œäºˆå®šã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›´ã€ã‚„ã€Œç‰¹å®šã®ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¸ã®ç§»å‹•ã€ãªã©ã€æ‰‹ä½œæ¥­ã ã¨æ™‚é–“ãŒã‹ã‹ã‚‹å‡¦ç†ã‚’è‡ªå‹•åŒ–ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚ŠåŠ¹ç‡çš„ã«ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ç®¡ç†ã§ãã¾ã™ã€‚

ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç®¡ç†ãŒã‚¹ãƒ ãƒ¼ã‚ºã«ãªã‚Šã€æ—¥ã€…ã®ç”Ÿç”£æ€§ãŒå‘ä¸Šã—ãŸã¨æ„Ÿã˜ã¦ã„ãŸã ã‘ãŸã‚‰å¹¸ã„ã§ã™ã€‚

---
## æ ªå¼ä¼šç¤¾ONE WEDGEã€‚
ã€Serverlessã§ä¸–ã®ä¸­ã‚’ã‚‚ã£ã¨æ¥½ã—ãã€‘
ONE WEDGEã¯Serverlessã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºã‚’ä¸­æ ¸æŠ€è¡“ã¨ã—ã¦Webç³»ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºã€AWS/GCPã‚’åˆ©ç”¨ã—ãŸæ¥­å‹™ã‚·ã‚¹ãƒ†ãƒ ãƒ»ã‚µãƒ¼ãƒ“ã‚¹é–‹ç™ºã€PWAã‚’ç”¨ã„ãŸãƒ¢ãƒã‚¤ãƒ«é–‹ç™ºã€Alexaã‚¹ã‚­ãƒ«é–‹ç™ºãªã©ã€å…ƒæ°—ã¨æŠ€è¡“åŠ›ã‚’æ­¦å™¨ã«ãŠå®¢æ§˜ã«çœŸæ‘¯ã«å‘ãåˆã†ä¾¡å€¤å‰µé€ ä¼æ¥­ã§ã™ã€‚
https://onewedge.co.jp/