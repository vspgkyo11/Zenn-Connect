---
title: "【Node.js】AWS EC2 (Debian 12) で Node.js 20 から v24/v25 へアップグレードガイド"
emoji: "🚀"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["nodejs","linux","debian","aws"]
published: true
---

![](/images/nodejs20-upgrade/zenn_nodejs20-24-25.png)

## はじめに

クラウド環境での運用において、ランタイムのアップデートは避けて通れません。2025年10月に `Node.js v25`が `Current` としてリリースされ、`Node.js v24`が`LTS(Long Term Support)`に昇格しました。

本記事では、本番環境において推奨されるランタイムバージョン管理方法 および AWS EC2上のDebian 12環境において、既存の`Node.js v20`を最新の安定版（`v24`）または最新機能版（`v25`）へアップグレードする手順を解説します。

https://nodejs.org/en/about/previous-releases

## 対象者

- AWS EC2 (Debian 12 / Bookworm) を運用中のエンジニア
- ランタイムのバージョン管理をOS標準のパッケージ管理システムで行いたい方
- 本番環境におけるランタイムのバージョン管理のベストプラクティスを知りたい方

## 本番環境において推奨されるランタイムバージョン管理

開発環境ではバージョン切り替えが容易な `nvm` や `asdf` が重宝されますが、本番サーバーにおいては NodeSource リポジトリ経由の `apt` インストールが推奨されます。以下に理由を記載します。

### 推奨理由1. パスの固定化

`nvm` はシェル関数として動作し、`.bashrc` 等で `PATH` を動的に書き換えることでバージョンを切り替えます。しかし、systemd や cron はログインシェルを通さずに実行されるため、これら環境変数の恩恵を受けられず「コマンドが見つからない」といったトラブルの原因になりやすいです。

これに対し、`apt` でインストールされた Node.js は `/usr/bin/node` というシステム標準のパスに固定されます。ユニットファイルやジョブ設定内で複雑な環境変数を意識することなく、シンプルかつ確実にバイナリを実行できるのがメリットです。

### 推奨理由2. セキュリティ更新の自動化

OS パッケージ管理システム（APT）を利用することで、OS 本体のセキュリティアップデート (`apt update / upgrade`) のサイクルに Node.js のパッチ適用を組み込むことができます。

独自の管理ツール（`nvm`）を用いる場合、各サーバーにログインして手動で更新作業を行う必要が生じ、運用漏れのリスクが高まります。それに対して、`apt` は、システム全体で一元管理できます。そのため、自動パッチ適用ツール等との相性も良いです。

| 比較項目       | apt (NodeSource)             | nvm / asdf                    |
| :------------- | :--------------------------- | :---------------------------- |
| **推奨環境**   | **本番サーバー・商用環境**   | ローカル開発・検証環境        |
| **パスの性質** | `/usr/bin/node` (固定・永続) | `~/.nvm/...`, `~/.asdf/...` (動的・環境依存) |
| **実行主体**   | システム全体 (root/System)   | ログインユーザー単位          |
| **更新管理**   | `apt upgrade` で一括管理     | 手動またはツール独自の管理    |
| **安定性**     | 非ログイン環境でも確実に動作 | シェル設定の読み込みに依存    |

## アップグレード手順

### 1. 現状確認

作業前に現在のバージョンとインストール経路を確認します。

```bash
# 現在のバージョンを確認
node -v
# 期待値: v20.x.x

# npmの場所を確認
which npm
# /usr/bin/npm (aptの場合)
```

### 2. 旧リポジトリ設定のクリーンアップ

Debian 12 では `/etc/apt/sources.list.d/` 配下にリポジトリ設定があります。新旧バージョンの競合を防ぐため、既存の設定を削除します。

```bash
# 既存設定の確認
ls /etc/apt/sources.list.d/nodesource.list

# 設定ファイルの削除
sudo rm -f /etc/apt/sources.list.d/nodesource.list
```

### 3. Node.js v24 (LTS) の導入

NodeSource が提供するセットアップスクリプトを使用し、v24 のリポジトリをシステムに追加します。

```bash
# セットアップスクリプトの取得と実行 (v24 LTS)
curl -fsSL https://deb.nodesource.com/setup_24.x | sudo -E bash -

# v25 (Current) を導入したい場合はこちら
# curl -fsSL https://deb.nodesource.com/setup_25.x | sudo -E bash -
```

:::message
**LTS（Long Term Support）と Current とは**
LTS（v24）は長期間の保守が保証された本番環境推奨版です。一方、Current（v25）は最新機能が含まれますがサポート期間が短いため、用途に合わせて選択してください。
:::

:::message alert
**注意事項**
最新機能を利用したい場合は、URLを `setup_25.x` に変更することで v25 (Current) をインストール可能です。ただし、本番運用にはサポート期間の長い LTS (v24) を推奨します。
:::

### 4. インストールとビルドツールの整備

リポジトリ更新後、パッケージをインストールします。ネイティブモジュールのコンパイルに備え、`build-essential` も同時に確認します。

```bash
sudo apt-get install -y nodejs build-essential
```

### 5. 動作確認

バージョンが正しく更新されたことを確認します。

```bash
node -v
# v24.x.x

npm -v
# v10.x.x (Node.js v24同梱版)
```

最後に、既存プロジェクトの依存関係を再構築して完了です。

```bash
# プロジェクトディレクトリにて
rm -rf node_modules package-lock.json
npm install
```

## おわりに

私自身、ランタイムの管理方針について、開発環境の利便性をそのまま本番に持ち込もうとしていましたが、調査していくうちに、OS の作法（パッケージ管理）に従うことが、長期的なメンテナンスコストを低減するための選択であることを知りました。本記事が、インフラ運用の一助になれば幸いです。

---

## 株式会社ONE WEDGE
【Serverlessで世の中をもっと楽しく】
ONE WEDGEはServerlessシステム開発を中核技術としてWeb系システム開発、AWS/GCPを利用した業務システム・サービス開発、PWAを用いたモバイル開発、Alexaスキル開発など、元気と技術力を武器にお客様に真摯に向き合う価値創造企業です。
https://onewedge.co.jp/